<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="/styles.css">
    <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <title>메인화면</title>
</head>
<body>
<div id="login-items">
    <button onclick="join()" id="joinBtn">회원가입</button>
    <button onclick="login()" id="loginBtn">로그인</button>
    <form action="/logout" method="get">
        <input type="submit" id="logout" value="로그아웃">
    </form>
</div>
<h1 id="logo">동아리 관리 시스템</h1>
<nav id="main-nav">
    <div id="menu-items">
        <button onclick="boardSaveReq()" id="boardSaveBtn">글 작성</button>
        <button onclick="boardListReq()" id="boardListBtn">글 목록</button>
        <button onclick="boardPagingReq()" id="boardPagingBtn">글 페이지</button>
        <button onclick="rentReq()" id="rentBtn">대여 시스템</button>
        <button onclick="todoReq()" id="todoBtn">일정 관리</button>
        <button onclick="clubReq()" id="clubBtn">동아리 현황</button>
        <button th:if="${id != 'anonymousUser'}" onclick="favoriteReq()" id="favoriteBtn">즐겨찾기 조회</button>
    </div>
</nav>

<!-------------------------------------------------------------------------------------------------------------------->
<div id="main-content">
    <h1>환영합니다, </h1>
    <p>당신의 역할은: <span id="userRole" th:text="${role}"></span></p>
    <hr>
</div>

<div id="main-container" th:if="${not #strings.equals(id, 'anonymousUser')}">
<!--    <div id="login-container">-->
<!--        <h2>회원 정보</h2>-->
<!--        <div id="login-box">-->
<!--            소속 동아리명 : <span id="clubName" th:text="${clubDTO.clubName}"></span>-->
<!--            이름 : <span id="userId" th:text="${id}"></span>-->
<!--            동아리 호실 : <span id="clubRoom" th:text="${clubDTO.clubRoom}"></span>-->
<!--        </div>-->
<!--    </div>-->



    <div id="todo-container">
        <div class="todo-box" id="receive-todo-list">
            <h3>동연회 요청</h3>
            <div id="receive-todo-items" th:if="${not #strings.equals(id, 'anonymousUser')}">
                <table th:if="${receiveTodoList != null}">
                    <tr>
                        <th>제목</th>
                        <th>마감일</th>
                        <th>남은 일수</th>
                    </tr>
                    <tr th:each="todo: ${receiveTodoList}">
                        <td><a th:href="@{|/todo/receivcedTodo/${clubId}/${todo.id}|}" th:text="${todo.title}"></a></td>
                        <td th:text="*{#temporals.format(todo.endTime, 'yy.MM.dd   HH:mm')}"></td>
                        <td th:text="*{#temporals.format(todo.endTime, 'yy.MM.dd   HH:mm')}"></td>
                    </tr>
                </table>
            </div>

        </div>


        <div class="todo-box" id="my-todo-list">
            <h3>나의 일정 목록</h3>
            <div id="my-todo-items" th:if="${not #strings.equals(id, 'anonymousUser')}">
                <table th:if="${myTodoList != null}">
                    <tr>
                        <th>제목</th>
                        <th>시작일</th>
                        <th>종료일</th>
                    </tr>
                    <tr th:each="todo: ${myTodoList}">
                        <td><a th:href="@{|/todo/myTodoList/${clubId}/${todo.id}|}" th:text="${todo.title}"></a></td>
                        <td th:text="*{#temporals.format(todo.startTime, 'yy.MM.dd   HH:mm')}"></td>
                        <td th:text="*{#temporals.format(todo.endTime, 'yy.MM.dd   HH:mm')}"></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
</body>

<script th:inline="javascript">

    const id = [[${id}]];
    const receiveTodoList = [[${receiveTodoList}]];

    const join = () => {
        location.href="/join";
    }

    const login = () => {
        location.href="/login";
    }

    const boardSaveReq = () => {
        location.href="/board/save";
    }
    const boardListReq = () => {
        location.href="/board/list";
    }
    const boardPagingReq = () => {
        location.href="/board/paging";
    }

    const favoriteReq = () => {
        location.href="/favorite/list"
    }

    const rentReq = () => {
        location.href="/rental/"
    }

    const clubReq = () => {
        location.href="/club/"
    }

    const todoReq = () => {
        if (id.startsWith('admin')) {
            location.href="/todo/admin";
        } else {
            location.href="/todo/user";
        }
    }

</script>
</html>
